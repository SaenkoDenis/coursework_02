# –ö—É—Ä—Å–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ 2
## Data Scientist. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

–ö—É—Ä—Å–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π ‚Äì –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π. **–î–ª—è –∑–∞—á–µ—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏.** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞–Ω–∏—è Python.

- [–ß–∞—Å—Ç—å –ø–µ—Ä–≤–∞—è](#–ß–∞—Å—Ç—å-–ø–µ—Ä–≤–∞—è)
- [–ß–∞—Å—Ç—å –≤—Ç–æ—Ä–∞—è](#–ß–∞—Å—Ç—å-–≤—Ç–æ—Ä–∞—è)

## –ß–∞—Å—Ç—å –ø–µ—Ä–≤–∞—è

–ü–µ—Ä–µ–¥ –≤–∞–º–∏ —Å—Ç–æ–∏—Ç –∑–∞–¥–∞—á–∞ ‚Äì –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç –¥–ª—è HR-–æ—Ç–¥–µ–ª–∞. –ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–¥–µ–ª–∞ –∫–∞–¥—Ä–æ–≤ –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, –∞ —Ç–∞–∫–∂–µ –ø–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é —Å —É–∂–µ –∏–º–µ—é—â–∏–º–∏—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏.
<br><br> –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ª–µ–∂–∏—Ç –Ω–∞–±–æ—Ä —Ç–∞–±–ª–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞–Ω–Ω—ã–µ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö –≤—ã–º—ã—à–ª–µ–Ω–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏.
–°–¥–µ–ª–∞–π—Ç–µ –æ–±–∑–æ—Ä —à—Ç–∞—Ç–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏. –°–æ—Å—Ç–∞–≤—å—Ç–µ –Ω–∞–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Ö –Ω–∞ –¥–∞–Ω–Ω—ã—Ö. –í—Å—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–ø–æ–ª–µ–Ω–∞ —Å –ø–æ–º–æ—â—å—é SQL. –í–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –æ–¥–Ω–∞–∫–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é SQL.
```python
# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ Psycopg2, Numpy, Pandas
import psycopg2
import numpy as np
import pandas as pd

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
conn = psycopg2.connect(**{'host': 'dsstudents.skillbox.ru', 
                           'port': 5432, 
                           'dbname': 'human_resources', 
                           'user': 'readonly', 
                           'password': '6hajV34RTQfmxhS'})

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü—ã hr_dataset
hr_df = pd.read_sql_query('select * from hr_dataset', conn).info()
```
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 310 entries, 0 to 309
    Data columns (total 29 columns):
     #   Column               Non-Null Count  Dtype  
    ---  ------               --------------  -----  
     0   id                   310 non-null    int64  
     1   Employee Name        310 non-null    object 
     2   Employee Number      310 non-null    int64  
     3   marriedid            310 non-null    int64  
     4   maritalstatusid      310 non-null    int64  
     5   genderid             310 non-null    int64  
     6   empstatus_id         310 non-null    int64  
     7   deptid               310 non-null    int64  
     8   perf_scoreid         310 non-null    int64  
     9   age                  310 non-null    int64  
     10  Pay Rate             310 non-null    float64
     11  state                310 non-null    object 
     12  zip                  310 non-null    int64  
     13  dob                  310 non-null    object 
     14  sex                  310 non-null    object 
     15  maritaldesc          310 non-null    object 
     16  citizendesc          310 non-null    object 
     17  Hispanic/Latino      310 non-null    object 
     18  racedesc             310 non-null    object 
     19  Date of Hire         310 non-null    object 
     20  Days Employed        310 non-null    int64  
     21  Date of Termination  103 non-null    object 
     22  Reason For Term      310 non-null    object 
     23  Employment Status    310 non-null    object 
     24  department           310 non-null    object 
     25  position             310 non-null    object 
     26  Manager Name         310 non-null    object 
     27  Employee Source      310 non-null    object 
     28  Performance Score    310 non-null    object 
    dtypes: float64(1), int64(11), object(17)
    memory usage: 70.4+ KB
    
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü—ã production_staff
pd.read_sql_query('select * from production_staff', conn).info()
```
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 256 entries, 0 to 255
    Data columns (total 16 columns):
     #   Column               Non-Null Count  Dtype  
    ---  ------               --------------  -----  
     0   id                   256 non-null    int64  
     1   Employee Name        209 non-null    object 
     2   Race Desc            209 non-null    object 
     3   Date of Hire         209 non-null    object 
     4   TermDate             83 non-null     object 
     5   Reason for Term      209 non-null    object 
     6   Employment Status    209 non-null    object 
     7   Department           209 non-null    object 
     8   Position             209 non-null    object 
     9   Pay                  209 non-null    object 
     10  Manager Name         209 non-null    object 
     11  Performance Score    209 non-null    object 
     12  Abutments/Hour Wk 1  208 non-null    float64
     13  Abutments/Hour Wk 2  208 non-null    float64
     14  Daily Error Rate     208 non-null    float64
     15  90-day Complaints    208 non-null    float64
    dtypes: float64(4), int64(1), object(11)
    memory usage: 32.1+ KB

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü—ã recruiting_cost
pd.read_sql_query('select * from recruiting_costs', conn).info()
```
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 22 entries, 0 to 21
    Data columns (total 15 columns):
     #   Column             Non-Null Count  Dtype 
    ---  ------             --------------  ----- 
     0   id                 22 non-null     int64 
     1   Employment Source  22 non-null     object
     2   January            22 non-null     int64 
     3   February           22 non-null     int64 
     4   March              22 non-null     int64 
     5   April              22 non-null     int64 
     6   May                22 non-null     int64 
     7   June               22 non-null     int64 
     8   July               22 non-null     int64 
     9   August             22 non-null     int64 
     10  September          22 non-null     int64 
     11  October            22 non-null     int64 
     12  November           22 non-null     int64 
     13  December           22 non-null     int64 
     14  Total              22 non-null     int64 
    dtypes: int64(14), object(1)
    memory usage: 2.7+ KB

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü—ã salary_grid
pd.read_sql_query("select * from salary_grid", conn).info()
```
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 12 entries, 0 to 11
    Data columns (total 8 columns):
     #   Column      Non-Null Count  Dtype  
    ---  ------      --------------  -----  
     0   id          12 non-null     int64  
     1   Position    12 non-null     object 
     2   Salary Min  12 non-null     int64  
     3   Salary Mid  12 non-null     int64  
     4   Salary Max  12 non-null     int64  
     5   Hourly Min  12 non-null     float64
     6   Hourly Mid  12 non-null     float64
     7   Hourly Max  12 non-null     float64
    dtypes: float64(3), int64(4), object(1)
    memory usage: 896.0+ bytes
    
### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ 1. –í–æ–∑—Ä–∞—Å—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –µ–≥–æ —Ä–∞–±–æ—Ç—ã. –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –≤ —Ä–∞–±–æ—Ç–µ –¥–æ–ø—É—Å–∫–∞—é—Ç –±–æ–ª—å—à–µ –æ—à–∏–±–æ–∫.
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –∫–æ–º–ø–∞–Ω–∏–∏
sql_query = '''
    select hr.age, pr."Daily Error Rate" as daily_error_rate
    from hr_dataset hr 
    left join production_staff pr on 
        (hr."Employee Name" = pr."Employee Name") and (hr."Date of Hire" = pr."Date of Hire") and 
        (hr.position = pr."Position")'''

staff_df = pd.read_sql_query(sql_query, conn).fillna(0)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –≥—Ä—É–ø–ø —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏
age_range = pd.cut(staff_df['age'], [0, 30, 50, 80])

# –í—ã–≤–æ–¥ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫, –ø—Ä–∏—Ö–æ–¥—è—â–µ–µ—Å—è –Ω–∞ –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã
staff_df.pivot_table(values='daily_error_rate', index=age_range, aggfunc=np.mean)
```
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>age</th>
      <th>daily_error_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(0, 30]</th>
      <td>0.372549</td>
    </tr>
    <tr>
      <th>(30, 50]</th>
      <td>0.638393</td>
    </tr>
    <tr>
      <th>(50, 80]</th>
      <td>0.714286</td>
    </tr>
  </tbody>
</table>
</div>

```python
# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –¥–∏–∞–≥—Ä–∞–º–º
%matplotlib inline

# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Matplotlib
import matplotlib.pyplot as plt

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º—ã
fig, ax = plt.subplots(figsize=(6, 4))

# –û—Ç—Ä–∞–∂–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã
staff_df.pivot_table(values='daily_error_rate', index=age_range, aggfunc=np.mean).plot.bar(
    ax=ax, width=0.2, title='–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö\n –æ—à–∏–±–æ–∫ –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã', rot=0, legend=None)

# –í—ã–≤–æ–¥ –ø–æ–¥–ø–∏—Å–µ–π –æ—Å–µ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
ax.set_xlabel('–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞')
ax.set_ylabel('–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª. –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫')

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
plt.show()
```
![png](Images/output_9_0.png)
    
### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ 2. –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ - —Å–∞–º—ã–µ –≤—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –∫–æ–º–ø–∞–Ω–∏–∏
sql_query = 'select age, "Pay Rate" as pay_rate from hr_dataset'
staff_df = pd.read_sql_query(sql_query, conn).fillna(0)

# –í—ã–≤–æ–¥ –º–µ–¥–∏–∞–Ω—ã –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã
staff_df.pivot_table(values='pay_rate', index=age_range, aggfunc=np.median)
```
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>age</th>
      <th>pay_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(0, 30]</th>
      <td>28.00</td>
    </tr>
    <tr>
      <th>(30, 50]</th>
      <td>23.25</td>
    </tr>
    <tr>
      <th>(50, 80]</th>
      <td>26.00</td>
    </tr>
  </tbody>
</table>
</div>

```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º—ã
fig, ax = plt.subplots(figsize=(6, 4))

# –û—Ç—Ä–∞–∂–µ–Ω–∏–µ –º–µ–¥–∏–∞–Ω—ã –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã
staff_df.pivot_table(values='pay_rate', index=age_range, aggfunc=np.median).plot.bar(
    ax=ax, width=0.2, title='–ú–µ–¥–∏–∞–Ω–∞ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤\n –¥–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã', rot=0, legend=None)

# –í—ã–≤–æ–¥ –ø–æ–¥–ø–∏—Å–µ–π –æ—Å–µ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
ax.set_xlabel('–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞')
ax.set_ylabel('–ú–µ–¥–∏–∞–Ω–∞ –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞')

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
plt.show()
```
![png](Images/output_12_0.png)
    
### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ 3. –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –º–æ–ª–æ–¥–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ –±–æ–ª—å—à–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω—ã —á–∞—Å—Ç–æ–π —Å–º–µ–Ω–µ —Ä–∞–±–æ—Ç—ã
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –∫–æ–º–ø–∞–Ω–∏–∏
sql_query = 'select age, "Days Employed" as days_employed from hr_dataset'
staff_df = pd.read_sql_query(sql_query, conn).fillna(0)

# –í—ã–≤–æ–¥ –º–µ–¥–∏–∞–Ω—ã –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã
staff_df.pivot_table(values='days_employed', index=age_range, aggfunc=np.median)
```
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>age</th>
      <th>days_employed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(0, 30]</th>
      <td>1112</td>
    </tr>
    <tr>
      <th>(30, 50]</th>
      <td>1291</td>
    </tr>
    <tr>
      <th>(50, 80]</th>
      <td>1238</td>
    </tr>
  </tbody>
</table>
</div>

```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º—ã
fig, ax = plt.subplots(figsize=(6, 4))

# –û—Ç—Ä–∞–∂–µ–Ω–∏–µ –º–µ–¥–∏–∞–Ω—ã –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã
staff_df.pivot_table(values='days_employed', index=age_range, aggfunc=np.median).plot.bar(
    ax=ax, width=0.2, title='–ú–µ–¥–∏–∞–Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞\n –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã', 
    rot=0, legend=None)

# –í—ã–≤–æ–¥ –ø–æ–¥–ø–∏—Å–µ–π –æ—Å–µ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
ax.set_xlabel('–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞')
ax.set_ylabel('–ú–µ–¥–∏–∞–Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞')

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
plt.show()
```
![png](Images/output_15_0.png)
    
### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ 4. –ò–º–º–∏–≥—Ä–∞–Ω—Ç—ã –∏ –Ω–µ–≥—Ä–∞–∂–¥–∞–Ω–µ —Å—Ç—Ä–∞–Ω—ã –º–µ–Ω–µ–µ –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –∫–æ–º–ø–∞–Ω–∏–∏
sql_query = '''
    select hr.citizendesc, pr."Daily Error Rate" as daily_error_rate
    from hr_dataset hr 
    left join production_staff pr on 
        (hr."Employee Name" = pr."Employee Name") and (hr."Date of Hire" = pr."Date of Hire") and 
        (hr.position = pr."Position")'''

staff_df = pd.read_sql_query(sql_query, conn).fillna(0)

# –í—ã–≤–æ–¥ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫ —É –≥—Ä—É–ø–ø —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "citizendesc"
staff_df.pivot_table(values='daily_error_rate', index='citizendesc', aggfunc=np.mean)
```
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>citizendesc</th>
      <th>daily_error_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Eligible NonCitizen</th>
      <td>0.750000</td>
    </tr>
    <tr>
      <th>Non-Citizen</th>
      <td>1.250000</td>
    </tr>
    <tr>
      <th>US Citizen</th>
      <td>0.588435</td>
    </tr>
  </tbody>
</table>
</div>

```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º—ã
fig, ax = plt.subplots(figsize=(6, 4))

# –û—Ç—Ä–∞–∂–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–∏—Å–ª–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫ —É –≥—Ä—É–ø–ø —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "citizendesc"
staff_df.pivot_table(values='daily_error_rate', index='citizendesc', aggfunc=np.mean).plot.bar(
    ax=ax, width=0.2, title='–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫ —É\n –≥—Ä—É–ø–ø —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "citizendesc"', 
    rot=0, legend=None)

# –í—ã–≤–æ–¥ –ø–æ–¥–ø–∏—Å–µ–π –æ—Å–µ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
ax.set_xlabel('–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞')
ax.set_ylabel('–ú–µ–¥–∏–∞–Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞')

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
plt.show()
```
![png](Images/output_18_0.png)
    
### –í—ã–≤–æ–¥

–í—Å–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –≥–∏–ø–æ—Ç–µ–∑—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏—Å—å, –∫—Ä–æ–º–µ –æ–¥–Ω–æ–π - "*–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ - —Å–∞–º—ã–µ –≤—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏*". –°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ –¥–∞–Ω–Ω–æ–π –≥–∏–ø–æ—Ç–µ–∑–µ, –Ω–∞–∏–±–æ–ª—å—à–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫ –ø–æ–ª—É—á–∞—é—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏–∑ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã –Ω–µ —Å—Ç–∞—Ä—à–µ 30.

–í –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, –º–æ–∂–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –ø–æ—Ä—Ç—Ä–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:
1. —Å–æ–≥–ª–∞—Å–Ω–æ –≥–∏–ø–æ—Ç–µ–∑–∞–º 1-3, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑ –≥—Ä—É–ø–ø—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (–æ—Ç 30 –¥–æ 50), —Ç–∞–∫ –∫–∞–∫ –≤ —Ä–∞–±–æ—Ç–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ä–µ–¥–Ω–µ–≥–æ, –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫ –∏ –º–µ–Ω—å—à–µ –≤—Å–µ–≥–æ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω —á–∞—Å—Ç—ã–º —Å–º–µ–Ω–∞–º —Ä–∞–±–æ—Ç—ã;
2. —Å–æ–≥–ª–∞—Å–Ω–æ –≥–∏–ø–æ—Ç–µ–∑–µ 4, —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω–æ–º –°–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –®—Ç–∞—Ç–æ–≤ –ê–º–µ—Ä–∏–∫–∏, —Ç–∞–∫ –∫–∞–∫ –±–æ–ª–µ–µ –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É –∏ –º–µ–Ω—å—à–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫.

## –ß–∞—Å—Ç—å –≤—Ç–æ—Ä–∞—è

–ü–µ—Ä–µ–¥ –≤–∞–º–∏ —Å—Ç–æ–∏—Ç –∑–∞–¥–∞—á–∞ ‚Äì –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç –¥–ª—è SMM-–æ—Ç–¥–µ–ª–∞ –∫–æ–º–ø–∞–Ω–∏–∏ Skillbox. <br> –û–±—ä–µ–∫—Ç–æ–º –∞–Ω–∞–ª–∏–∑–∞ —è–≤–ª—è–µ—Ç—Å—è  [–ø–∞–±–ª–∏–∫ Skillbox –í–∫–æ–Ω—Ç–∞–∫—Ç–µ](https://vk.com/skillbox_education). <br> <br> 
–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫  API VK –∏ –≤—ã–≥—Ä—É–∑–∏—Ç–µ –ø–æ—Å—Ç—ã —Å–æ —Å—Ç–µ–Ω—ã –ø–∞–±–ª–∏–∫–∞ Skillbox –∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –ø–µ—Ä–∏–æ–¥ (–æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏ –æ–±–æ—Å–Ω—É–π—Ç–µ). –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Ä–µ–º–µ–Ω–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏) –Ω–∞ –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –≥–æ–ª–æ—Å–æ–≤ –≤ –æ–ø—Ä–æ—Å–∞—Ö). –°–¥–µ–ª–∞–π—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ —Ä—É–±—Ä–∏–∫–∞–º (–ø—Ä–∏–º–µ—Ä—ã —Ä—É–±—Ä–∏–∫: –¥–∏–∑–∞–π–Ω-–±–∏—Ç–≤–∞, –∏–≥—Ä–∞ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é), –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –ø–∞–±–ª–∏–∫–µ. –í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ –ø–æ—Å—Ç—ã –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π. –°–æ—Å—Ç–∞–≤—å—Ç–µ –ø–µ—Ä–µ—á–µ–Ω—å —Ä–µ–∫–æ–º–∞–Ω–¥–∞—Ü–∏–π –¥–ª—è SMM-–æ—Ç–¥–µ–ª–∞ –ø–æ –∏—Ç–æ–≥–∞–º –∞–Ω–∞–ª–∏–∑–∞.
```python
# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ Math, Requests, Numpy –∏ Pandas
import math
import requests
import numpy as np
import pandas as pd

# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ DateTime
from datetime import datetime

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
url = 'https://api.vk.com/method/wall.get'
token = '72dcb67872dcb67872dcb6785b72ae8662772dc72dcb6782c1740804e0b1207aa8a90ff'
domain = 'skillbox_education'
version = 5.107
offset = 0

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å—Ç–æ–≤ –Ω–∞ —Å—Ç–µ–Ω–µ –ø–∞–±–ª–∏–∫–∞ Skillbox
response = requests.get(url, params={'access_token': token, 'v': version, 'domain': domain, 'count': 1})
count_posts = response.json()['response']['count']

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤ —Å—Ç–µ–Ω—ã –ø–∞–±–ª–∏–∫–∞ Skillbox
all_posts = list()

while offset <= math.ceil(count_posts / 100) * 100:
    response = requests.get(url, params={'access_token': token, 'v': version, 'domain': domain, 'count': 100, 'offset': offset})
    all_posts.extend(response.json()['response']['items'])
    offset += 100

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å –≤—ã–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –ø–æ—Å—Ç–∞–º–∏ 
posts_df = pd.json_normalize(all_posts)

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∫–æ–ª–æ–Ω–∫–µ 'date' –≤ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã
posts_df['date'] = posts_df['date'].apply(datetime.fromtimestamp)

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–ª–æ–Ω–∫–µ 'text' –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
posts_df['text'] = posts_df['text'].str.lower()
```

### –ê–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Ä–µ–º–µ–Ω–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏) –Ω–∞ –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –≥–æ–ª–æ—Å–æ–≤ –≤ –æ–ø—Ä–æ—Å–∞—Ö)
```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º—ã
fig, axes = plt.subplots(4, 1, figsize=(10, 12))

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
chart_df = posts_df.pivot_table(
    values=['views.count', 'likes.count', 'reposts.count', 'comments.count'], 
    index=pd.to_datetime(10000 * 2020 + 100 * posts_df.date.dt.month + posts_df.date.dt.day, format='%Y%m%d'), 
    aggfunc=np.median)

# –°–ª–æ–≤–∞—Ä—å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
titles = {'views': '–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –ø–æ—Å—Ç–æ–≤ –ø–∞–±–ª–∏–∫–∞ Skillbox',
          'likes':'–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤ –ø–æ—Å—Ç–æ–≤ –ø–∞–±–ª–∏–∫–∞ Skillbox', 
          'reposts': '–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–æ—Å—Ç–æ–≤ –ø–æ—Å—Ç–æ–≤ –ø–∞–±–ª–∏–∫–∞ Skillbox', 
          'comments': '–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ—Å—Ç–æ–≤ –ø–∞–±–ª–∏–∫–∞ Skillbox'}

# –í—ã–≤–æ–¥ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
chart_df['views.count'].plot(ax=axes[0], color='tab:blue', title = titles['views'])
chart_df['likes.count'].plot(ax=axes[1], color='tab:orange', title = titles['likes'])
chart_df['reposts.count'].plot(ax=axes[2], color='tab:green', title = titles['reposts'])
chart_df['comments.count'].plot(ax=axes[3], color='tab:red', title = titles['comments'])

# –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –æ—Å–µ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
for ax in axes.flat:
    ax.set(xlabel=None, ylabel=None)

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≥—Ä–∞—Ñ–∏–∫–∞
fig.tight_layout()

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
plt.show()
```
![png](Images/output_25_0.png)
    
### –í—ã–≤–æ–¥

–ù–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö, –æ—Ç—Ä–∞–∂–∞—é—â–∏—Ö –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –≥–æ–¥–∞ –≤–∏–¥–Ω–æ, —á—Ç–æ –≤ –ø–µ—Ä–∏–æ–¥—ã —Å –∞–ø—Ä–µ–ª—è –ø–æ –∏—é–ª—å –∏ —Å –æ–∫—Ç—è–±—Ä—è –ø–æ –¥–µ–∫–∞–±—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–æ—è–≤–ª—è—é—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π –∏–Ω—Ç–µ—Ä–µ—Å –∫ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–º—É –º–∞—Ç–µ—Ä–∏–∞–ª—É –Ω–∞ —Å—Ç–µ–Ω–µ –ø–∞–±–ª–∏–∫–∞ Skillbox. –í –≤–µ—Å–µ–Ω–Ω–µ-–ª–µ—Ç–Ω–∏–π –ø–µ—Ä–∏–æ–¥ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–∏–π, –Ω–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –∫ –ø–æ—Å—Ç–∞–º –ø–∞–±–ª–∏–∫–∞ Skillbox.

### –ê–Ω–∞–ª–∏–∑ –ø–æ —Ä—É–±—Ä–∏–∫–∞–º (–ø—Ä–∏–º–µ—Ä—ã —Ä—É–±—Ä–∏–∫: –¥–∏–∑–∞–π–Ω-–±–∏—Ç–≤–∞, –∏–≥—Ä–∞ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é), –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –ø–∞–±–ª–∏–∫–µ

#### –í—ã–≤–æ–¥ —Å–∞–º—ã—Ö –ø—É–±–ª–∏–∫—É–µ–º—ã—Ö —Ä—É–±—Ä–∏–∫ –ø–∞–±–ª–∏–∫–∞ Skillbox
```python
# –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
import re

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Ä—É–±—Ä–∏–∫
rubric_list = posts_df['text'].str.findall('#\w+').apply(lambda x: ','.join(x)).to_list()
rubric_list = ','.join(rubric_list).split(',')

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Ä—É–±—Ä–∏–∫
rubric_df = pd.DataFrame({'rubric': rubric_list, 'count': 1})

# –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ –ø—É—Å—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
rubric_df = rubric_df.query('rubric!=""')

# –í—ã–≤–æ–¥ 10 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ä—É–±—Ä–∏–∫
rubric_df.groupby('rubric').count().sort_values('count', ascending=False).head(10)
```
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>rubric</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>#—Ü–∏—Ç–∞—Ç—ã</th>
      <td>768</td>
    </tr>
    <tr>
      <th>#–∞—Ñ–æ—Ä–∏–∑–º—ã</th>
      <td>764</td>
    </tr>
    <tr>
      <th>#read</th>
      <td>370</td>
    </tr>
    <tr>
      <th>#skillbox</th>
      <td>359</td>
    </tr>
    <tr>
      <th>#business</th>
      <td>319</td>
    </tr>
    <tr>
      <th>#skillbox_–¥–∏–∑–∞–π–Ω</th>
      <td>203</td>
    </tr>
    <tr>
      <th>#marketing</th>
      <td>202</td>
    </tr>
    <tr>
      <th>#design</th>
      <td>198</td>
    </tr>
    <tr>
      <th>#code</th>
      <td>190</td>
    </tr>
    <tr>
      <th>#—Å—Ç–∞—Ç—å—è_skillbox</th>
      <td>160</td>
    </tr>
  </tbody>
</table>
</div>

#### –ê–Ω–∞–ª–∏–∑ –ø–æ—Å—Ç–æ–≤ –∏–∑ —Ä—É–±—Ä–∏–∫–∏ "skillbox_–¥–∏–∑–∞–π–Ω"
```python
# –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è Dates –ø–∞–∫–µ—Ç–∞ Matplotlib
import matplotlib.dates as mdates

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º—ã
fig, axes = plt.subplots(3, 1, figsize=(10, 9))

# –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
index_list = posts_df['text'].str.contains('#skillbox_–¥–∏–∑–∞–π–Ω')

chart_df = posts_df[index_list].pivot_table(
    values=['likes.count', 'reposts.count', 'comments.count'],
    index=posts_df['date'].astype('datetime64[D]'), 
    aggfunc=np.median)

# –°–ª–æ–≤–∞—Ä—å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
titles = {'likes':'–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∞—Ç—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏', 
          'reposts': '–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–æ—Å—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∞—Ç—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏', 
          'comments': '–ú–µ–¥–∏–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∞—Ç—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏'}

# –í—ã–≤–æ–¥ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
chart_df['likes.count'].plot(ax=axes[0], color='tab:orange', title=titles['likes'])
chart_df['reposts.count'].plot(ax=axes[1], color='tab:green', title=titles['reposts'])
chart_df['comments.count'].plot(ax=axes[2], color='tab:red', title=titles['comments'])

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –º–µ—Ç–æ–∫ –æ—Å–µ–π
for ax in axes.flat:
    ax.xaxis.set_major_locator(mdates.MonthLocator())
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%b %y'))

# –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –æ—Å–µ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
for ax in axes.flat:
    ax.set(xlabel=None, ylabel=None)

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≥—Ä–∞—Ñ–∏–∫–∞
fig.tight_layout()

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
plt.show()
```
![png](Images/output_32_0.png)
    
```python
# –í—ã–≤–æ–¥ –ø–æ—Å—Ç–æ–≤ –≤—ã–∑–≤–∞–≤—à–∏–µ –Ω–∞–∏–±–æ–ª—å—à–∏–π –∏–Ω—Ç–µ—Ä–µ—Å –≤ –î–µ–∫–∞–±—Ä–µ –º–µ—Å—è—Ü–µ
month_df = posts_df[['date', 'text', 'likes.count', 'reposts.count', 'comments.count']]
month_df = month_df.query('date > "2019.11.25" & date < "2019.12.10"')
month_df = month_df[month_df['text'].str.contains('#skillbox_–¥–∏–∑–∞–π–Ω')]

# –í—ã–≤–æ–¥ –ø–æ—Å—Ç–æ–≤
month_df
```
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>text</th>
      <th>likes.count</th>
      <th>reposts.count</th>
      <th>comments.count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>301</th>
      <td>2019-12-07 11:00:01</td>
      <td>—Å—Ç—É–¥–∏—è warner bros. —á–∞—Å—Ç–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç —Å–≤–æ–π –ª–æ–≥–æ...</td>
      <td>46</td>
      <td>2</td>
      <td>89</td>
    </tr>
    <tr>
      <th>305</th>
      <td>2019-12-05 17:00:10</td>
      <td>—Å–æ–∑–¥–∞—Ç—å –∏–ª–∏ —Å–∫–∞—á–∞—Ç—å ‚Äî –≤–æ—Ç –≤ —á–µ–º –≤–æ–ø—Ä–æ—Å. –¥–∞-–¥–∞,...</td>
      <td>69</td>
      <td>11</td>
      <td>4</td>
    </tr>
    <tr>
      <th>306</th>
      <td>2019-12-05 12:22:09</td>
      <td>–∫–æ –¥–Ω—é —Ä–æ–∂–¥–µ–Ω–∏—è —É–æ–ª—Ç–∞ –¥–∏—Å–Ω–µ—è, ¬´–æ—Ç—Ü–∞¬ª –º–∏–∫–∫–∏ –º–∞—É...</td>
      <td>262</td>
      <td>32</td>
      <td>3</td>
    </tr>
    <tr>
      <th>307</th>
      <td>2019-12-04 19:00:01</td>
      <td>–¥–∏–∑–∞–π–Ω–µ—Ä—ã, –æ—Ç–≤–ª–µ–∫–∏—Ç–µ—Å—å –æ—Ç –∏–≥—Ä —Å–æ —à—Ä–∏—Ñ—Ç–∞–º–∏. –ª–æ–≤...</td>
      <td>643</td>
      <td>129</td>
      <td>5</td>
    </tr>
    <tr>
      <th>327</th>
      <td>2019-11-26 11:43:14</td>
      <td>–µ—Å–ª–∏ –¥–∞–≤–Ω–æ —Ö–æ—Ç–µ–ª–∏ –Ω–∞—É—á–∏—Ç—å—Å—è —Ä–∏—Å–æ–≤–∞—Ç—å –≤ —Å—Ç–∏–ª–µ p...</td>
      <td>129</td>
      <td>8</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div>
```python
# –í—ã–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ª–∞–π–∫–æ–≤
month_df['text'][month_df['likes.count'].idxmax()]
```
    '–¥–∏–∑–∞–π–Ω–µ—Ä—ã, –æ—Ç–≤–ª–µ–∫–∏—Ç–µ—Å—å –æ—Ç –∏–≥—Ä —Å–æ —à—Ä–∏—Ñ—Ç–∞–º–∏. –ª–æ–≤–∏—Ç–µ –ø–æ–¥–±–æ—Ä–∫—É –∏–∑ —Å–µ–º–∏ —Ñ–∏–ª—å–º–æ–≤ –∏ —Å–µ—Ä–∏–∞–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å—à–∏—Ä—è—Ç –≤–∞—à –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫—Ä—É–≥–æ–∑–æ—Ä.\n\n#–≤_–∑–∞–∫–ª–∞–¥–∫–∏_skillbox #skillbox_–¥–∏–∑–∞–π–Ω'

```python
# –í—ã–≤–æ–¥ –ø–æ—Å—Ç–æ–≤ –≤—ã–∑–≤–∞–≤—à–∏–µ –Ω–∞–∏–±–æ–ª—å—à–∏–π –∏–Ω—Ç–µ—Ä–µ—Å –≤ –§–µ–≤—Ä–∞–ª–µ –º–µ—Å—è—Ü–µ
month_df = posts_df[['date', 'text', 'likes.count', 'reposts.count', 'comments.count']]
month_df = month_df.query('date > "2020.02.05" & date < "2020.02.15"')
month_df = month_df[month_df['text'].str.contains('#skillbox_–¥–∏–∑–∞–π–Ω')]

# –í—ã–≤–æ–¥ –ø–æ—Å—Ç–æ–≤
month_df
```
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>text</th>
      <th>likes.count</th>
      <th>reposts.count</th>
      <th>comments.count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>174</th>
      <td>2020-02-14 11:21:30</td>
      <td>–±—ã—Ç—å —á–∞—Å—Ç—å—é —Ü–µ–ª–æ–≥–æ, –Ω–æ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è —Å–æ–±–æ–πüòè apple...</td>
      <td>213</td>
      <td>13</td>
      <td>7</td>
    </tr>
    <tr>
      <th>176</th>
      <td>2020-02-13 11:59:51</td>
      <td>–¥–∏–∑–∞–π–Ω–µ—Ä—ã, —Å–æ–±—Ä–∞–ª–∏ –¥–ª—è –≤–∞—Å —Å–∞–π—Ç—ã, –≥–¥–µ –º–æ–∂–Ω–æ –±–µ...</td>
      <td>540</td>
      <td>94</td>
      <td>4</td>
    </tr>
    <tr>
      <th>177</th>
      <td>2020-02-12 18:46:18</td>
      <td>—Ç–æ—á–∫–∞, —Ç–æ—á–∫–∞, –∑–∞–ø—è—Ç–∞—è, ‚Äì –≤—ã—à–ª–∞ —Ä–æ–∂–∏—Ü–∞ –∫—Ä–∏–≤–∞—è. ...</td>
      <td>72</td>
      <td>10</td>
      <td>5</td>
    </tr>
    <tr>
      <th>181</th>
      <td>2020-02-11 12:22:05</td>
      <td>–Ω—É–∂–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π, –∞ photoshop –Ω–µ—Ç –ø...</td>
      <td>610</td>
      <td>108</td>
      <td>0</td>
    </tr>
    <tr>
      <th>183</th>
      <td>2020-02-10 16:53:20</td>
      <td>—Å–µ–≥–æ–¥–Ω—è –Ω–µ –±—É–ª—å–≤–∞—Ä–Ω–æ–µ —á—Ç–∏–≤–æ –≤ –º–æ–¥–µ, –∞ –º–æ–¥–∞ –≤ –±...</td>
      <td>68</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>187</th>
      <td>2020-02-08 14:28:34</td>
      <td>—É —Ç–∞–ª–∞–Ω—Ç–ª–∏–≤–æ–≥–æ –¥–∏–∑–∞–π–Ω–µ—Ä–∞ –¥–∞–∂–µ —Å–∞–º—ã–µ —Å—Ç—Ä–∞—à–Ω—ã–µ –º...</td>
      <td>122</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>188</th>
      <td>2020-02-07 12:31:03</td>
      <td>–µ–≤—Ä–æ–≤–∏–¥–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç –ª–æ–≥–æ—Ç–∏–ø –∫–∞–∂–¥—ã–π –≥–æ–¥, –Ω–æ –Ω–∞ —ç...</td>
      <td>24</td>
      <td>0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>192</th>
      <td>2020-02-06 11:31:11</td>
      <td>–Ω–∞ –≤–∫—É—Å –∏ —Ü–≤–µ—Ç —Ç–æ–≤–∞—Ä–∏—â–∞ –Ω–µ—Ç? –Ω–∞—Å—á–µ—Ç –≤–∫—É—Å–∞ —Å–æ–≥–ª...</td>
      <td>479</td>
      <td>92</td>
      <td>11</td>
    </tr>
    <tr>
      <th>193</th>
      <td>2020-02-05 19:11:06</td>
      <td>–Ω–µ –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å—Å—è —Å —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä–æ–π –¥–ª—è...</td>
      <td>110</td>
      <td>23</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

```python
# –í—ã–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ª–∞–π–∫–æ–≤
month_df['text'][month_df['likes.count'].idxmax()]
```
    '–Ω—É–∂–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π, –∞ photoshop –Ω–µ—Ç –ø–æ–¥ —Ä—É–∫–æ–π? –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –Ω–µ –∏—â–∏—Ç–µ, –º—ã —É–∂–µ –≤—Å–µ —Å–æ–±—Ä–∞–ª–∏ –¥–ª—è –≤–∞—Å.\n\ncanva. –≤ –≤–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏ –º–∏–ª–ª–∏–æ–Ω—ã —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π, –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–π, —Å–æ—Ç–Ω–∏ —à—Ä–∏—Ñ—Ç–æ–≤, –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∫–æ–Ω–æ–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤. —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è –ª—é–±—ã—Ö —Ü–µ–ª–µ–π. —Å–æ—Ü—Å–µ—Ç–∏, –æ–±–ª–æ–∂–∫–∏ –¥–ª—è –±–ª–æ–≥–æ–≤ –∏ –∫–Ω–∏–≥, –æ—Ç–∫—Ä—ã—Ç–∫–∏, –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞, —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω–æ–µ –º–µ–Ω—é ‚Äî canva –º–æ–∂–µ—Ç –ø–æ—á—Ç–∏ –≤—Å–µ.\n\ncrello. –∑–¥–µ—Å—å –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —Å–æ —Å—Ç–∞—Ç–∏—á–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –Ω–æ –¥–∞–∂–µ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π. –Ω–µ –Ω—Ä–∞–≤—è—Ç—Å—è –∏–º–µ—é—â–∏–µ—Å—è —à—Ä–∏—Ñ—Ç—ã? –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ–∏, –≤ —ç—Ç–æ–º –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –∫—Å—Ç–∞—Ç–∏, –¥–ª—è –≤–∞—à–µ–≥–æ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è —Å–æ–±—Ä–∞–Ω–∞ —Ü–µ–ª–∞—è –≥–∞–ª–µ—Ä–µ—è –≥–æ—Ç–æ–≤—ã—Ö —Ä–∞–±–æ—Ç.\n\nadobe spark. –≤ —Å–µ—Ä–≤–∏—Å–µ –µ—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å. –Ω–∏—á–µ–≥–æ, –µ—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –æ–ø—ã—Ç–∞ –≤ –¥–∏–∑–∞–π–Ω–µ: adobe spark –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥—É –¥–∞–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏.\n\ngiphy gif maker. –ø—Ä–æ—Å—Ç–æ–π –∏ —É–¥–æ–±–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–∏—Ñ–æ–∫. –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–∫–∞—á–∏–≤–∞—Ç—å –≤–∏–¥–µ–æ: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞—Ç—å –Ω–∞ –Ω–µ–≥–æ —Å—Å—ã–ª–∫—É. –∫ –≥–∏—Ñ–∫–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞–¥–ø–∏—Å–∏, —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å—Ç–∏–∫–µ—Ä—ã. –∏–∑ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤: —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –≤–∏–¥–µ–æ –¥–æ 15 –º–∏–Ω—É—Ç.\n\nget stencill. –≤ —ç—Ç–æ–º —Å–µ—Ä–≤–∏—Å–µ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫—Ä—É—Ç—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π, –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—É—é —Ä–µ–∫–ª–∞–º—É, –±—Ä–æ—Å–∫–∏–µ –æ–±–ª–æ–∂–∫–∏ –¥–ª—è –±–ª–æ–≥–æ–≤ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ. –±–æ–ª–µ–µ 60 –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤, —Å–≤—ã—à–µ 1000 —à–∞–±–ª–æ–Ω–æ–≤, 100 000 —Ü–∏—Ç–∞—Ç –¥–ª—è –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –æ–∫–æ–ª–æ 3 000 —à—Ä–∏—Ñ—Ç–æ–≤.\n\n#–≤_–∑–∞–∫–ª–∞–¥–∫–∏_skillbox #skillbox_–¥–∏–∑–∞–π–Ω #skillbox_–º–∞—Ä–∫–µ—Ç–∏–Ω–≥'

```python
# –í—ã–≤–æ–¥ –ø–æ—Å—Ç–æ–≤ –≤—ã–∑–≤–∞–≤—à–∏–µ –Ω–∞–∏–±–æ–ª—å—à–∏–π –∏–Ω—Ç–µ—Ä–µ—Å –≤ –ú–∞–µ –º–µ—Å—è—Ü–µ
month_df = posts_df[['date', 'text', 'likes.count', 'reposts.count', 'comments.count']]
month_df = month_df.query('date > "2020.05.01" & date < "2020.05.15"')
month_df = month_df[month_df['text'].str.contains('#skillbox_–¥–∏–∑–∞–π–Ω')]

# –í—ã–≤–æ–¥ –ø–æ—Å—Ç–æ–≤
month_df
```
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>text</th>
      <th>likes.count</th>
      <th>reposts.count</th>
      <th>comments.count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21</th>
      <td>2020-05-14 11:55:07</td>
      <td>–∫–æ–≥–¥–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–∏—Ä –≤—ã—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞—Ä—É–∂—É. \n\n–º–∞...</td>
      <td>140</td>
      <td>5</td>
      <td>12</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2020-05-13 12:08:31</td>
      <td>–∫–∞–∫ –±—ã –≤—ã–≥–ª—è–¥–µ–ª–æ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, –µ—Å–ª–∏ –±—ã –µ–≥–æ –≤–∏–∑—É...</td>
      <td>162</td>
      <td>10</td>
      <td>16</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2020-05-11 16:52:19</td>
      <td>–∫–∞–∂–¥—ã–π –≤–∏–¥ –∏—Å–∫—É—Å—Å—Ç–≤–∞ –ø–æ-—Å–≤–æ–µ–º—É –ø—Ä–µ–∫—Ä–∞—Å–µ–Ω. –Ω–æ –≤...</td>
      <td>47</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2020-05-06 12:20:16</td>
      <td>—Å—Ä–æ—á–Ω–æ –Ω—É–∂–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è –≤ —Å–æ—Ü—Å–µ—Ç–∏, –∞ —É –¥–∏–∑–∞–π–Ω–µ—Ä–∞...</td>
      <td>917</td>
      <td>179</td>
      <td>20</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2020-05-05 12:30:12</td>
      <td>–∫–∞–∫ –≤–∞–º —Ç–∞–∫–æ–π –ø–∞—Ä–∞–¥–æ–∫—Å–∞–ª—å–Ω—ã–π –∂–∞–Ω—Ä: –≥–∏–ø–µ—Ä—Ä–µ–∞–ª—å–Ω...</td>
      <td>140</td>
      <td>12</td>
      <td>19</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2020-05-04 11:34:37</td>
      <td>–¥–∞ –ø—Ä–µ–±—É–¥—É—Ç —Å –≤–∞–º–∏ —Å–∫–∏–ª–ª—ã! —Å–µ–≥–æ–¥–Ω—è –ø—Ä–∞–∑–¥–Ω–∏–∫ —É ...</td>
      <td>150</td>
      <td>7</td>
      <td>19</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2020-05-03 15:38:01</td>
      <td>–ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å —Å—Ç–∏–ª—É—Å –≤ –∫–∏—Å—Ç–∏ —ç–¥–≤–∞—Ä–¥–∞ –º—É–Ω–∫–∞? –∏ —Ç–∞–∫...</td>
      <td>148</td>
      <td>13</td>
      <td>0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2020-05-02 16:05:33</td>
      <td>—Å–∞–º–∞—è –±–æ–ª—å—à–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤ ux-–¥–∏–∑–∞–π–Ω–µ ‚Äî –æ–±—ä—è—Å–Ω–∏...</td>
      <td>214</td>
      <td>35</td>
      <td>27</td>
    </tr>
    <tr>
      <th>38</th>
      <td>2020-05-01 13:58:50</td>
      <td>–º–∏—Ä! —Ç—Ä—É–¥! –º–∞–π! –¥–∏–∑–∞–π–Ω!\n\n–ø—Ä–∞–∑–¥–Ω–∏–∫ –≤–µ—Å–Ω—ã –∏ —Ç—Ä...</td>
      <td>120</td>
      <td>3</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>

```python
# –í—ã–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ª–∞–π–∫–æ–≤
month_df['text'][month_df['likes.count'].idxmax()]
```
    '—Å—Ä–æ—á–Ω–æ –Ω—É–∂–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è –≤ —Å–æ—Ü—Å–µ—Ç–∏, –∞ —É –¥–∏–∑–∞–π–Ω–µ—Ä–∞ –º–∞–π—Å–∫–∏–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏?\n\n–ª–æ–≤–∏—Ç–µ –ø–æ–¥–±–æ—Ä–∫—É —Å–µ—Ä–≤–∏—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç ¬´–æ–∂–∏–≤–∏—Ç—å¬ª –∫–∞—Ä—Ç–∏–Ω–∫—É, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—ã –Ω–µ —É–º–µ–µ—Ç–µ —Ä–∏—Å–æ–≤–∞—Ç—å. —á–∏—Ç–∞–π—Ç–µ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö!\n\n#–≤_–∑–∞–∫–ª–∞–¥–∫–∏_skillbox #skillbox_–¥–∏–∑–∞–π–Ω'

### –í—ã–≤–æ–¥

–û–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –ø—É–±–ª–∏–∫—É–µ–º—ã—Ö —Ä—É–±—Ä–∏–∫ –Ω–∞ –ø–∞–±–ª–∏–∫–µ Skillbox - "#Skillbox_–î–∏–∑–∞–π–Ω" (203 –ø—É–±–ª–∏–∫–∞—Ü–∏–∏). –ê–Ω–∞–ª–∏–∑ –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –¥–∞–Ω–Ω–æ–π —Ä—É–±—Ä–∏–∫–µ, –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥ –µ–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –Ω–∞ –î–µ–∫–∞–±—Ä—å, –§–µ–≤—Ä–∞–ª—å –∏ –ú–∞–π –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞–∏–±–æ–ª—å—à–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –î–µ–∫–∞–±—Ä–µ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –ø–æ—Å—Ç–∞ —Å –ø–æ–¥–±–æ—Ä–∫–æ–π –∏–∑ —Å–µ–º–∏ —Ñ–∏–ª—å–º–æ–≤ –∏ —Å–µ—Ä–∏–∞–ª–æ–≤, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ –Ω–∞–∏–±–æ–ª—å—à–∏–π –æ—Ç–∫–ª–∏–∫ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í –§–µ–≤—Ä–∞–ª–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏—à–ª–∞—Å—å –Ω–∞ –ø–æ—Å—Ç —Å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≤ –ú–∞–µ - –ø–æ—Å—Ç —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏ –ø–æ "–æ–∂–∏–≤–ª–µ–Ω–∏—é" –∫–∞—Ä—Ç–∏–Ω–æ–∫.

–ò–∑ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ —Ä—É–±—Ä–∏–∫–µ "#Skillbox_–î–∏–∑–∞–π–Ω" —Å–ª–µ–¥—É–µ—Ç, —á—Ç–æ –Ω–∞–∏–±–æ–ª—å—à–µ–π –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å—é —Å—Ä–µ–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ—Å—Ç—ã —Å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º–∏ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, –∞ —Ç–∞–∫–∂–µ –ø–æ—Å—Ç—ã —Å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ø–æ–¥–∞—á–µ–π –º–∞—Ç–µ—Ä–∏–∞–ª–∞.

### –†–µ–∫–æ–º–∞–Ω–¥–∞—Ü–∏–∏ –¥–ª—è SMM-–æ—Ç–¥–µ–ª–∞

–£—á–∏—Ç—ã–≤–∞—è —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø—É–±–ª–∏–∫—É–µ–º–æ–π –Ω–∞ —Å—Ç–µ–Ω–µ Skillbox, –æ—Å–Ω–æ–≤–Ω—É—é –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—é –∫—É—Ä—Å–æ–≤ –ª—É—á—à–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤ –≤–µ—Å–µ–Ω–Ω–µ-–ª–µ—Ç–Ω–∏–π –ø–µ—Ä–∏–æ–¥.

–¢–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–æ–¥–∞—á—É –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø–æ—Å—Ç–æ–≤ - –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø–æ–¥–∞—á–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∏–¥–µ–æ –º–∞—Ç–µ—Ä–∏–∞–ª. –°—Ä–µ–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–ø—É–ª—è—Ä–Ω—ã –ø–æ—Å—Ç—ã —Å —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç—å—é - –ø–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –∏ –ø–æ–ª—É—á–∏—Ç—å —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
